(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{7888:function(e,t,s){Promise.resolve().then(s.bind(s,762))},473:function(e,t,s){"use strict";var r=s(4660),a=s(4810),n=s(2265);let l=(0,r.Ue)()((0,a.tJ)((e,t)=>({vertical:"vehicles",currentStep:0,totalSteps:7,answers:{},resultsCount:0,setVertical:t=>{e({vertical:t,currentStep:0,answers:{},resultsCount:0,totalSteps:"vehicles"===t?7:4})},setAnswer:(t,s)=>{e(e=>({answers:{...e.answers,[t]:s}}))},setAnswers:t=>{e({answers:t})},setResultsCount:t=>{e({resultsCount:t})},nextStep:()=>{e(e=>({currentStep:Math.min(e.currentStep+1,e.totalSteps-1)}))},prevStep:()=>{e(e=>({currentStep:Math.max(e.currentStep-1,0)}))},goToStep:s=>{let{totalSteps:r}=t();e({currentStep:Math.max(0,Math.min(s,r-1))})},reset:()=>{e({currentStep:0,answers:{},resultsCount:0})},isStepValid:e=>{let{answers:s}=t(),r=s[e];return!!r&&(Array.isArray(r)?2===r.length&&"number"==typeof r[0]&&"number"==typeof r[1]?r[0]>0&&r[1]>0:r.length>0:null!=r&&""!==r)}}),{name:"wizard-storage",partialize:e=>({vertical:e.vertical,currentStep:e.currentStep,answers:e.answers,resultsCount:e.resultsCount})}));t.Z=()=>{let[e,t]=(0,n.useState)(!1),s=l();return(0,n.useEffect)(()=>{t(!0)},[]),e?s:{vertical:"vehicles",currentStep:0,totalSteps:7,answers:{},resultsCount:0,setVertical:()=>{},setAnswer:()=>{},setAnswers:()=>{},setResultsCount:()=>{},nextStep:()=>{},prevStep:()=>{},goToStep:()=>{},reset:()=>{},isStepValid:()=>!1}}},762:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var r=s(7437),a=s(2265),n=s(4033),l=s(3067),i=s(9251),o=s(998),c=s(473);class d{generateSessionId(){return"".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9))}track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("[Analytics]",e,{...t,sessionId:this.sessionId,timestamp:Date.now(),url:window.location.href,userAgent:"undefined"!=typeof navigator?navigator.userAgent:void 0})}identify(e,t){console.log("[Analytics] Identify",e,t)}reset(){this.sessionId=this.generateSessionId(),console.log("[Analytics] Session reset")}constructor(){this.sessionId=this.generateSessionId()}}let u=new d;var m=s(286),x=s(6691),h=s.n(x),p=s(1657),b=s(2245),f=s(2442),g=s(5790);function v(e){let{title:t,subtitle:s,image:a,price:n,monthlyPrice:l,score:i,reasons:o,features:c,ctaLabel:d="Ver detalles",onCtaClick:u,highlighted:m=!1,valuationData:x,onValuationClick:v}=e;return(0,r.jsxs)("article",{className:(0,p.cn)("rounded-2xl border bg-white shadow-card overflow-hidden transition-all hover:shadow-lg",m?"border-brand ring-2 ring-brand/20":"border-neutral-200"),children:[m&&(0,r.jsx)("div",{className:"bg-brand text-white text-center py-2 text-sm font-medium",children:"Mejor opci\xf3n para ti"}),a&&(0,r.jsxs)("div",{className:"aspect-[16/9] bg-neutral-50 relative",children:[(0,r.jsx)(h(),{src:a,alt:t,fill:!0,className:"object-cover",sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"}),(0,r.jsxs)("div",{className:"absolute top-3 right-3 bg-white/90 backdrop-blur-sm rounded-full px-3 py-1.5 flex items-center gap-1",children:[(0,r.jsx)(b.Z,{className:"h-4 w-4 text-yellow-500 fill-current"}),(0,r.jsxs)("span",{className:"text-sm font-semibold text-neutral-900",children:[i,"/100"]})]})]}),(0,r.jsxs)("div",{className:"p-5",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-neutral-900",children:t}),s&&(0,r.jsx)("p",{className:"text-sm text-neutral-600 mt-0.5",children:s}),(0,r.jsxs)("div",{className:"mt-4 flex items-baseline gap-2",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-neutral-900",children:n}),l&&(0,r.jsxs)("div",{className:"text-sm text-neutral-600",children:["o ",l,"/mes"]})]}),o.length>0&&(0,r.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:o.map((e,t)=>(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs px-2.5 py-1 rounded-full bg-brand/10 text-brand border border-brand/20",children:[(0,r.jsx)(f.Z,{className:"h-3 w-3"}),e]},t))}),c&&c.length>0&&(0,r.jsx)("ul",{className:"mt-4 space-y-2",children:c.map((e,t)=>(0,r.jsxs)("li",{className:"flex items-start gap-2 text-sm text-neutral-600",children:[(0,r.jsx)(f.Z,{className:"h-4 w-4 text-green-600 flex-shrink-0 mt-0.5"}),(0,r.jsx)("span",{children:e})]},t))}),(0,r.jsxs)("div",{className:"mt-5 flex gap-2",children:[(0,r.jsx)("button",{onClick:u,className:"flex-1 bg-brand text-white rounded-2xl px-4 py-2.5 font-medium hover:opacity-90 active:opacity-80 transition-opacity focus-ring",children:d}),x&&v&&(0,r.jsxs)("button",{onClick:v,className:"px-4 py-2.5 bg-neutral-100 text-neutral-700 rounded-2xl font-medium hover:bg-neutral-200 transition-all flex items-center gap-2",title:"Ver tasaci\xf3n",children:[(0,r.jsx)(g.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Tasaci\xf3n"})]})]})]})]})}var j=s(1827),N=s(1981);function w(e){let{title:t="No encontramos resultados",description:s="Intenta ajustar tus preferencias para ver m\xe1s opciones",icon:a="search",action:n}=e,l="search"===a?j.Z:N.Z;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[(0,r.jsx)("div",{className:"w-16 h-16 rounded-full bg-neutral-100 flex items-center justify-center mb-4",children:(0,r.jsx)(l,{className:"h-8 w-8 text-neutral-400"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-neutral-900 text-center mb-2",children:t}),(0,r.jsx)("p",{className:"text-sm text-neutral-600 text-center max-w-sm",children:s}),n&&(0,r.jsx)("button",{onClick:n.onClick,className:"mt-6 px-4 py-2 bg-brand text-white rounded-xl font-medium hover:opacity-90 transition-opacity focus-ring",children:n.label})]})}function y(){let e=(0,n.useRouter)(),{vertical:t,answers:s,reset:d}=(0,c.Z)(),[x,h]=(0,a.useState)([]),[p,b]=(0,a.useState)(!0),[f,g]=(0,a.useState)(null),[j,N]=(0,a.useState)("recommended"),y=(0,a.useCallback)(async()=>{try{var e;b(!0),g(null);let r="vehicles"===t?"/api/recommender/vehicles":"/api/recommender/insurance",a=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw Error("Failed to fetch recommendations");let n=await a.json();h(n.items||[]),u.track("recommender_results_view",{vertical:t,resultsCount:(null===(e=n.items)||void 0===e?void 0:e.length)||0})}catch(e){console.error("Error fetching recommendations:",e),g("Error al cargar las recomendaciones. Por favor, intenta nuevamente.")}finally{b(!1)}},[t,s]);(0,a.useEffect)(()=>{y()},[y]);let C=(e,s)=>{u.track("recommender_select",{vertical:t,selectedId:e,score:s})},S=(t,s,r)=>{u.track("valuation_request",{from:"results",brand:t,model:s,year:r});let a=new URLSearchParams({brand:t,model:s,year:r.toString()});e.push("/valuation?".concat(a.toString()))},k=()=>{e.push("/")},A=e=>"vehicle"in e;return p?(0,r.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-8 bg-neutral-200 rounded w-1/3 mb-4"}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(e=>(0,r.jsx)("div",{className:"h-96 bg-neutral-200 rounded-2xl"},e))})]})}):f?(0,r.jsx)("div",{className:"max-w-3xl mx-auto",children:(0,r.jsx)(w,{title:"Ocurri\xf3 un error",description:f,icon:"alert",action:{label:"Intentar nuevamente",onClick:y}})}):0===x.length?(0,r.jsx)("div",{className:"max-w-3xl mx-auto",children:(0,r.jsx)(w,{title:"No encontramos resultados",description:"Intenta ajustar tus preferencias para ver m\xe1s opciones",action:{label:"Ajustar preferencias",onClick:k}})}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-neutral-900",children:"dashboard"===j?"Dashboard de Scraping":"used"===j?"Veh\xedculos Usados Disponibles":"Lo que mejor calza contigo"}),(0,r.jsx)("p",{className:"mt-2 text-neutral-600",children:"dashboard"===j?"M\xe9tricas y estad\xedsticas en tiempo real":"used"===j?"Agregados de m\xfaltiples fuentes con an\xe1lisis IA":"Basado en tu presupuesto y preferencias"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("button",{onClick:k,className:"flex items-center gap-2 px-4 py-2 border border-neutral-300 rounded-xl hover:bg-neutral-50 transition-colors",children:[(0,r.jsx)(l.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Ajustar"})]}),(0,r.jsx)("button",{onClick:()=>{d(),e.push("/")},className:"px-4 py-2 text-neutral-600 hover:text-neutral-900 transition-colors",children:"Comenzar de nuevo"})]})]}),"vehicles"===t&&(0,r.jsxs)("div",{className:"flex gap-2 mb-8 border-b border-neutral-200",children:[(0,r.jsx)("button",{onClick:()=>N("recommended"),className:"px-4 py-3 font-medium transition-all border-b-2 ".concat("recommended"===j?"text-brand border-brand":"text-neutral-600 border-transparent hover:text-neutral-900"),children:"Recomendados para ti"}),(0,r.jsxs)("button",{onClick:()=>N("used"),className:"px-4 py-3 font-medium transition-all border-b-2 flex items-center gap-2 ".concat("used"===j?"text-brand border-brand":"text-neutral-600 border-transparent hover:text-neutral-900"),children:[(0,r.jsx)(i.Z,{className:"h-4 w-4"}),"Veh\xedculos Usados"]}),(0,r.jsxs)("button",{onClick:()=>N("dashboard"),className:"px-4 py-3 font-medium transition-all border-b-2 flex items-center gap-2 ".concat("dashboard"===j?"text-brand border-brand":"text-neutral-600 border-transparent hover:text-neutral-900"),children:[(0,r.jsx)(o.Z,{className:"h-4 w-4"}),"Dashboard"]})]}),"dashboard"===j?(0,r.jsx)("div",{className:"text-center py-12",children:"Dashboard coming soon..."}):"used"===j?(0,r.jsx)("div",{className:"text-center py-12",children:"Used vehicles section coming soon..."}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map((e,t)=>{if(A(e)){let s=e.vehicle;return(0,r.jsx)(v,{title:"".concat(s.brand," ").concat(s.model),subtitle:"".concat(s.year," \xb7 ").concat(s.engineSize,"L \xb7 ").concat("automatic"===s.transmission?"Autom\xe1tica":"Manual"),image:s.image,price:(0,m.O5)(s.priceCLP),monthlyPrice:e.monthlyEstimateCLP?(0,m.O5)(e.monthlyEstimateCLP):void 0,score:e.score,reasons:e.reasons,features:s.features.slice(0,3),highlighted:0===t,ctaLabel:"Ver detalles",onCtaClick:()=>C(s.id,e.score),valuationData:{brand:s.brand,model:s.model,year:s.year},onValuationClick:()=>S(s.brand,s.model,s.year)},s.id)}{let s=e.product,a=e.premium;return(0,r.jsx)(v,{title:s.productName,subtitle:s.provider,price:a?(0,m.O5)(a.monthlyPremiumCLP)+"/mes":"Cotizar",score:e.score,reasons:e.reasons,features:["brand"===s.features.workshopType&&"Taller de marca",s.features.replacementCar&&"Auto de reemplazo",s.features.roadAssistance&&"Asistencia en ruta",s.features.internationalCoverage&&"Cobertura internacional"].filter(Boolean),highlighted:0===t,ctaLabel:"Cotizar",onCtaClick:()=>C(s.id,e.score)},s.id)}})})]})}},1657:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var r=s(7042),a=s(4769);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,r.W)(t))}},286:function(e,t,s){"use strict";function r(e){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}s.d(t,{O5:function(){return r}})}},function(e){e.O(0,[985,690,730,971,938,744],function(){return e(e.s=7888)}),_N_E=e.O()}]);