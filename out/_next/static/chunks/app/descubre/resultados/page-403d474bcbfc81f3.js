(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[172],{3067:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(2898).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},7158:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(2898).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},6264:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(2898).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2245:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(2898).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])},8778:function(e,t,s){Promise.resolve().then(s.bind(s,3073))},3073:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var a=s(7437),n=s(2265),r=s(4033),l=s(3067),c=s(2898);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,c.Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var i=s(6264);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,c.Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);var u=s(2245),m=s(7158),x=s(1396),p=s.n(x),h=s(286),b=s(1657);function g(){let e=(0,r.useRouter)(),[t,s]=(0,n.useState)(null),[c,x]=(0,n.useState)([]),[g,f]=(0,n.useState)(!0),[y,j]=(0,n.useState)(null),[N,v]=(0,n.useState)([]),[w,S]=(0,n.useState)("price");(0,n.useEffect)(()=>{(async()=>{try{var t;f(!0),j(null);let a=localStorage.getItem("carDiscovery");if(!a){e.push("/descubre");return}let n=JSON.parse(a);console.log("Discovery data loaded:",n),s(n);let r=new URLSearchParams;n.budget&&n.budget.min&&n.budget.max&&(r.append("minPrice",n.budget.min.toString()),r.append("maxPrice",n.budget.max.toString())),n.bodyTypes&&n.bodyTypes.length>0&&r.append("bodyTypes",n.bodyTypes.join(",")),n.fuelTypes&&n.fuelTypes.length>0&&r.append("fuelTypes",n.fuelTypes.join(",")),n.brands&&n.brands.length>0&&r.append("brands",n.brands.join(",")),n.features&&n.features.length>0&&r.append("features",n.features.join(",")),console.log("Fetching vehicles with params:",r.toString());let l=await fetch("/api/discovery/vehicles?".concat(r)),c=await l.json();if(!l.ok)throw Error(c.error||"Failed to fetch vehicles");console.log("Vehicles fetched:",(null===(t=c.vehicles)||void 0===t?void 0:t.length)||0);let o=(c.vehicles||[]).map(e=>{let t=70,s=[];if(n.budget){let a="monthly"===n.paymentMode?e.monthlyPayment:e.price;a>=n.budget.min&&a<=n.budget.max&&(t+=10,s.push("Dentro de tu presupuesto"))}if(n.features.length>0){let a={economy:"Econ\xf3mico",space:"Espacioso",performance:"Alto rendimiento",safety:"Seguro",technology:"Tecnol\xf3gico",comfort:"Confortable",resale:"Buen valor de reventa",highway:"Ideal para carretera",cargo:"Gran capacidad de carga",maintenance:"F\xe1cil mantenimiento"};n.features.forEach(n=>{e.features[n]&&(t+=5,s.push(a[n]))})}return n.bodyTypes.includes(e.bodyType)&&(t+=5,s.push("Tipo de carrocer\xeda deseado")),n.fuelTypes.includes(e.fuelType)&&(t+=5,s.push("Tipo de combustible preferido")),n.brands.includes(e.brand)&&(t+=5,s.push("Marca preferida")),{...e,matchScore:Math.min(t,100),matchReasons:s}});o.sort((e,t)=>t.matchScore-e.matchScore),x(o)}catch(e){console.error("Error fetching vehicles:",e),j(e instanceof Error?e.message:"Error al cargar veh\xedculos")}finally{f(!1)}})()},[e]);let T=e=>{S(e);let t=[...c];"price"===e?t.sort((e,t)=>e.price-t.price):t.sort((e,t)=>e.monthlyPayment-t.monthlyPayment),x(t)},k=e=>{v(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},C={suv:"SUVs",sedan:"Saloons",hatchback:"Hatchbacks",pickup:"Pickup",coupe:"Coupes",minivan:"People carriers",wagon:"Estate cars",convertible:"Convertibles",sports:"Sports cars",commercial:"Comercial",other:"Otro"},E={gasoline:"Bencina",diesel:"Di\xe9sel",hybrid:"H\xedbrido",electric:"El\xe9ctrico",gas:"Gas"};return t?(0,a.jsxs)("div",{className:"min-h-screen bg-neutral-50",children:[(0,a.jsx)("header",{className:"bg-white border-b border-neutral-200 sticky top-0 z-40",children:(0,a.jsx)("div",{className:"container mx-auto px-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,a.jsxs)(p(),{href:"/descubre",className:"flex items-center gap-2 text-neutral-600 hover:text-neutral-900 transition-colors",children:[(0,a.jsx)(l.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"font-medium",children:"Modificar b\xfasqueda"})]}),(0,a.jsx)("h1",{className:"text-lg font-bold text-neutral-900",children:g?"Buscando...":"".concat(c.length," autos encontrados")}),(0,a.jsxs)("button",{className:"flex items-center gap-2 text-neutral-600 hover:text-neutral-900 transition-colors",children:[(0,a.jsx)(o,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"font-medium",children:"Filtros"})]})]})})}),(0,a.jsx)("div",{className:"bg-white border-b border-neutral-200",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-3 text-sm overflow-x-auto",children:[t.budget&&(0,a.jsxs)("span",{className:"px-3 py-1 bg-neutral-100 rounded-full whitespace-nowrap",children:[(0,h.O5)(t.budget.min)," - ",(0,h.O5)(t.budget.max)]}),t.bodyTypes&&t.bodyTypes.length>0&&(0,a.jsx)("span",{className:"px-3 py-1 bg-neutral-100 rounded-full",children:t.bodyTypes.map(e=>C[e]||e).join(", ")}),t.fuelTypes&&t.fuelTypes.length>0&&(0,a.jsx)("span",{className:"px-3 py-1 bg-neutral-100 rounded-full",children:t.fuelTypes.map(e=>E[e]||e).join(", ")}),t.brands&&t.brands.length>0&&(0,a.jsx)("span",{className:"px-3 py-1 bg-neutral-100 rounded-full",children:t.brands.join(", ")})]})})}),!g&&c.length>0&&(0,a.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("span",{className:"text-sm text-neutral-600",children:"Ordenar por:"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>T("price"),className:(0,b.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-all","price"===w?"bg-brand text-white":"bg-white text-neutral-700 hover:bg-neutral-50"),children:"Menor precio"}),"monthly"===t.paymentMode&&(0,a.jsx)("button",{onClick:()=>T("monthly"),className:(0,b.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-all","monthly"===w?"bg-brand text-white":"bg-white text-neutral-700 hover:bg-neutral-50"),children:"Menor cuota"})]})]})}),(0,a.jsx)("main",{className:"container mx-auto px-4 pb-8",children:g?(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center",children:[(0,a.jsx)(i.Z,{className:"h-12 w-12 animate-spin mx-auto mb-4 text-brand"}),(0,a.jsx)("p",{className:"text-xl text-neutral-600",children:"Buscando los mejores veh\xedculos para ti..."}),(0,a.jsx)("p",{className:"text-sm text-neutral-500 mt-2",children:"Esto puede tomar unos momentos mientras consultamos nuestra base de datos"})]}):y?(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center",children:[(0,a.jsx)("p",{className:"text-xl text-red-600 mb-4",children:"Error al cargar veh\xedculos"}),(0,a.jsx)("p",{className:"text-neutral-600 mb-4",children:y}),(0,a.jsx)(p(),{href:"/descubre",className:"inline-block px-6 py-3 bg-brand text-white rounded-lg font-medium hover:bg-brand/90 transition-all",children:"Volver a intentar"})]}):0===c.length?(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center",children:[(0,a.jsx)("p",{className:"text-xl text-neutral-600 mb-4",children:"No encontramos autos que coincidan con tus preferencias"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500 mb-6",children:"Intenta ajustar tus filtros para ver m\xe1s opciones"}),(0,a.jsx)(p(),{href:"/descubre",className:"inline-block px-6 py-3 bg-brand text-white rounded-lg font-medium hover:bg-brand/90 transition-all",children:"Modificar b\xfasqueda"})]}):(0,a.jsx)("div",{className:"grid lg:grid-cols-2 gap-6",children:c.map((e,s)=>(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-lg transition-all",children:[0===s&&e.matchScore>=80&&(0,a.jsxs)("div",{className:"bg-gradient-to-r from-green-500 to-green-600 text-white text-center py-2 text-sm font-medium",children:["\uD83C\uDFC6 Mejor match para ti (",e.matchScore,"%)"]}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-neutral-900",children:[e.brand," ",e.model]}),(0,a.jsxs)("p",{className:"text-sm text-neutral-600",children:[e.version," \xb7 ",e.year]}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500 mt-1",children:[C[e.bodyType]," \xb7 ",E[e.fuelType]," \xb7 ",e.transmission]})]}),(0,a.jsx)("button",{onClick:()=>k(e.id),className:"p-2 rounded-lg hover:bg-neutral-50 transition-all",children:(0,a.jsx)(d,{className:(0,b.cn)("h-5 w-5",N.includes(e.id)?"fill-red-500 text-red-500":"text-neutral-400")})})]}),e.matchScore&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("div",{className:"flex items-center gap-1",children:[void 0,void 0,void 0,void 0,void 0].map((t,s)=>(0,a.jsx)(u.Z,{className:(0,b.cn)("h-4 w-4",s<Math.floor(e.matchScore/20)?"fill-yellow-400 text-yellow-400":"text-neutral-300")},s))}),(0,a.jsxs)("span",{className:"text-sm font-medium text-neutral-700",children:[e.matchScore,"% match"]})]}),e.matchReasons&&e.matchReasons.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:e.matchReasons.slice(0,3).map((e,t)=>(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded-full",children:e},t))})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("div",{className:"flex items-baseline gap-2",children:(0,a.jsx)("p",{className:"text-2xl font-bold text-neutral-900",children:(0,h.O5)(e.price)})}),"monthly"===t.paymentMode&&(0,a.jsxs)("p",{className:"text-sm text-neutral-600",children:["Desde ",(0,h.O5)(e.monthlyPayment)," al mes"]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1 mb-4",children:[e.features.economy&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded",children:"Econ\xf3mico"}),e.features.space&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded",children:"Espacioso"}),e.features.safety&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded",children:"Seguro"}),e.features.technology&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded",children:"Tecnol\xf3gico"}),e.features.resale&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded",children:"Buena reventa"}),e.features.highway&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-purple-100 text-purple-700 rounded",children:"Carretero"}),e.features.cargo&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-orange-100 text-orange-700 rounded",children:"Carga"}),e.features.maintenance&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-yellow-100 text-yellow-700 rounded",children:"F\xe1cil mantenci\xf3n"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(p(),{href:"/configurar?brand=".concat(e.brand,"&model=").concat(e.model,"&year=").concat(e.year),className:"flex-1 px-4 py-2 bg-brand text-white rounded-lg font-medium hover:bg-brand/90 transition-all text-center",children:"Ver detalles"}),(0,a.jsxs)("button",{className:"px-4 py-2 border border-neutral-300 text-neutral-700 rounded-lg font-medium hover:bg-neutral-50 transition-all flex items-center gap-2",children:["Comparar",(0,a.jsx)(m.Z,{className:"h-4 w-4"})]})]})]})]},e.id))})})]}):null}},1657:function(e,t,s){"use strict";s.d(t,{cn:function(){return r}});var a=s(7042),n=s(4769);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,n.m6)((0,a.W)(t))}},286:function(e,t,s){"use strict";function a(e){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}s.d(t,{O5:function(){return a}})},4033:function(e,t,s){e.exports=s(5313)}},function(e){e.O(0,[221,985,971,938,744],function(){return e(e.s=8778)}),_N_E=e.O()}]);